# HW2 generative model based chat-bot

**Задание**: необходимо разработать чат-бот, используя генеративный подход. Бот должен вести диалог как определенный персонаж сериала, имитируя стиль и манеру конкретного персонажа сериала.

## Данные
В качестве основы для чат-бота я взяла скрипты к сериалу "Теория большого взрыва", которые есть на Kaggle и можно загрузить по [ссылке](https://www.kaggle.com/code/lydia70/big-bang-theory-tv-show/input).

Основной персонаж - Шелдон Купер :)

![image](https://github.com/shakhovak/chat_bot_katya_HW2/assets/89096305/b4e0e914-3070-483f-a88a-30fae33a61f7)

Данные на kaggle уже удобно разделены на реплики каждого персонажа и на отдельные сцены (ниже принт-скрин данных)

![image](https://github.com/shakhovak/chat_bot_katya/assets/89096305/100d2802-4837-40d9-95ad-c41034e184fb)

### Данные для retrieval-элемента чат-бота

Первоначальная обработка данных схожа с той, что я делала для предыдущего домашнего задания при подготовке retrieval-based чат-бота. 

Обработка данных подразумевает следующие шаги:
- отбор реплик персонажа в качестве ответов / answers. Именно из этих реплик будет выбирать бот свой ответ на высказывание пользователя.
- выделение предшествующей фразы как вопроса. Если это фраза первая в сцене, то это поле будет пустым.
- отбор предыдущих реплик как контекста диалога (ограничение не более 5 фраз в контексте). Если фраза первая в сцене, то контекст также будет пустым. Контекст - идущие подряд предложения. Я не стала разбивать на диалоги, как предлагалось на семинаре.
- сохранение файла в pickle формат для последующего использования алгоритмом (файл scripts.pkl)

Так как я буду использовать дополнение генерации retrieval данными по косинусной близости, то все начальные данные векторизую в базу данных (файл scripts_vectors.pkl). Для векторизации использую обученную в предыдущем задании модель bi-encoder, которую я сохранила в мой репозиторий на Hugging Face ([ссылка](https://huggingface.co/Shakhovak/chatbot_sentence-transformer)). Детально про обучение этой модели - в предыдущем задании ([ссылка на репозиторий](https://github.com/shakhovak/chat_bot_katya/tree/master))

Функции для обработки данных находятся в файле ```utils.py```:
1. ```scripts_rework_ranking``` - перерабатывает файл, как описано выше и сохраняет их в pkl формате
2. ```encode_df_save``` - использует переработанный файл и векторизует его, а вектора уже сохраняет в базу
   
### Данные для генеративной модели


